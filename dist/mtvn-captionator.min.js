!function(){"use strict";var a,b=10,c=16,d=4.5,e=1.5,f="white",g="Verdana, Helvetica, Arial, sans-serif",h="black",i={};window.captionator=i;var j=function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];if(0===d.indexOf("<")){var e=d.slice(0,d.indexOf(" ")),f="";if(-1!==d.indexOf('tts:fontstyle="italic"')&&(f+="font-style:italic;"),-1!==d.indexOf('tts:fontweight="bold"')&&(f+="font-weight:bold;"),-1!==d.indexOf("tts:color")){var g=d.match(/color=\"(.*)\"/);g.length>1&&(f+="color:"+g[1]+";")}f&&(d=e+' style="'+f+'">'),a[b]=d}}return a};i.CaptionatorCueStructure=function(a,b){var c=this;this.isTimeDependent=!1,this.cueSource=a,this.options=b,this.processedCue=null,this.toString=function(d){if(b.processCueHTML!==!1){var e=function(a,b){if(null===c.processedCue){var f,g,h="";for(f in a)f.match(/^\d+$/)&&a.hasOwnProperty(f)&&(g=a[f],g instanceof Object&&g.children&&g.children.length?"v"===g.token?h+='<q data-voice="'+g.voice.replace(/[\"]/g,"")+"\" class='voice "+"speaker-"+g.voice.replace(/[^a-z0-9]+/gi,"-").toLowerCase()+" webvtt-span' "+'title="'+g.voice.replace(/[\"]/g,"")+'">'+e(g.children,b+1)+"</q>":"c"===g.token?h+="<span class='webvtt-span webvtt-class-span "+g.classes.join(" ")+"'>"+e(g.children,b+1)+"</span>":g.timeIn>0?null===d||void 0===d||d>0&&d>=g.timeIn?h+="<span class='webvtt-span webvtt-timestamp-span' data-timestamp='"+g.token+"' data-timestamp-seconds='"+g.timeIn+"'>"+e(g.children,b+1)+"</span>":d<g.timeIn&&(h+="<span class='webvtt-span webvtt-timestamp-span webvtt-cue-future' aria-hidden='true' style='opacity: 0;' data-timestamp='"+g.token+"' data-timestamp-seconds='"+g.timeIn+"'>"+e(g.children,b+1)+"</span>"):h+=g.rawToken+e(g.children,b+1)+"</"+g.token+">":(g instanceof String||"string"==typeof g||"number"==typeof g)&&(h+=g));return c.isTimeDependent||0!==b||(c.processedCue=h),h}return c.processedCue};return e(this,0)}return a},this.getPlain=function(c){if(b.processCueHTML!==!1){var d=function(a,b){var e,f,g="";for(e in a)e.match(/^\d+$/)&&a.hasOwnProperty(e)&&(f=a[e],f instanceof Object&&f.children&&f.children.length?f.timeIn>0?(null===c||void 0===c||c>0&&c>=f.timeIn)&&(g+=d(f.children,b+1)):g+=d(f.children,b+1):(f instanceof String||"string"==typeof f||"number"==typeof f)&&(g+=f));return g};return d(this,0)}return a.replace(/<[^>]*>/gi,"")}},i.CaptionatorCueStructure.prototype=[],i.TextTrack=function(a,b,c,d,e,f){this.onload=function(){},this.onerror=function(){},this.oncuechange=function(){},this.id=a||"",this.internalMode=i.TextTrack.OFF,this.cues=new i.TextTrackCueList(this),this.activeCues=new i.ActiveTextTrackCueList(this.cues,this),this.kind=b||"subtitles",this.label=c||"",this.language=d||"",this.src=e||"",this.readyState=i.TextTrack.NONE,this.internalDefault=f||!1,this.getMode=function(){return this.internalMode},this.setMode=function(a){var b=[i.TextTrack.OFF,i.TextTrack.HIDDEN,i.TextTrack.SHOWING];if(-1===b.indexOf(a))throw new Error("Illegal mode value for track: "+a);a!==this.internalMode&&(this.internalMode=a,this.readyState===i.TextTrack.NONE&&this.src.length>0&&a>i.TextTrack.OFF&&this.loadTrack(this.src,null),this.videoElement._captionator_dirtyBit=!0,i.rebuildCaptions(this.videoElement),a===i.TextTrack.OFF&&(this.cues.length=0,this.readyState=i.TextTrack.NONE))},this.getDefault=function(){return this.internalDefault},Object.prototype.__defineGetter__?(this.__defineGetter__("mode",this.getMode),this.__defineSetter__("mode",this.setMode),this.__defineGetter__("default",this.getDefault)):Object.defineProperty&&(Object.defineProperty(this,"mode",{get:this.getMode,set:this.setMode}),Object.defineProperty(this,"default",{get:this.getDefault})),this.loadTrack=function(a,b){var c,d=new XMLHttpRequest;if(this.readyState===i.TextTrack.LOADED)b instanceof Function&&b(c);else{this.src=a,this.readyState=i.TextTrack.LOADING;var e=this;d.open("GET",a,!0),d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){var a=e.videoElement._captionatorOptions||{};"metadata"===e.kind&&(a.processCueHTML=!1,a.sanitiseCueHTML=!1),c=i.parseCaptions(d.responseText,a),e.readyState=i.TextTrack.LOADED,e.cues.loadCues(c),e.activeCues.refreshCues.apply(e.activeCues),e.videoElement._captionator_dirtyBit=!0,i.rebuildCaptions(e.videoElement),e.onload.call(this),b instanceof Function&&b.call(e,c)}else e.readyState=i.TextTrack.ERROR,e.onerror()};try{d.send(null)}catch(f){e.readyState=i.TextTrack.ERROR,e.onerror(f)}}},this.addCue=function(a){if(!(a&&a instanceof i.TextTrackCue))throw new Error("The argument is null or not an instance of TextTrackCue.");this.cues.addCue(a)},this.removeCue=function(){}},i.TextTrack.NONE=0,i.TextTrack.LOADING=1,i.TextTrack.LOADED=2,i.TextTrack.ERROR=3,i.TextTrack.OFF=0,i.TextTrack.HIDDEN=1,i.TextTrack.SHOWING=2,i.TextTrackCue=function(a,b,c,d,e,f,g){if(this.id=a,this.track=g instanceof i.TextTrack?g:null,this.startTime=parseFloat(b),this.endTime=parseFloat(c)>=this.startTime?parseFloat(c):this.startTime,this.text="string"==typeof d||d instanceof i.CaptionatorCueStructure?d:"",this.settings="string"==typeof e?e:"",this.intSettings={},this.pauseOnExit=!!f,this.wasActive=!1,this.direction="horizontal",this.snapToLines=!0,this.linePosition="auto",this.textPosition=50,this.size=0,this.alignment="middle",this.settings.length){var h=this.intSettings,j=this;e=e.split(/\s+/).filter(function(a){return a.length>0}),e instanceof Array&&e.forEach(function(a){var b={D:"direction",L:"linePosition",T:"textPosition",A:"alignment",S:"size"};a=a.split(":"),b[a[0]]&&(h[b[a[0]]]=a[1]),b[a[0]]in j&&(j[b[a[0]]]=a[1])})}this.linePosition.match(/\%/)&&(this.snapToLines=!1),this.getCueAsSource=function(){return String(this.text)},this.getCueAsHTML=function(){var a=document.createDocumentFragment(),b=document.createElement("div");return b.innerHTML=String(this.text),Array.prototype.forEach.call(b.childNodes,function(b){a.appendChild(b.cloneNode(!0))}),a},this.isActive=function(){var a=0;if(this.track instanceof i.TextTrack&&(this.track.mode===i.TextTrack.SHOWING||this.track.mode===i.TextTrack.HIDDEN)&&this.track.readyState===i.TextTrack.LOADED)try{if(a=this.track.videoElement.currentTime,this.startTime<=a&&this.endTime>=a)return this.wasActive||(this.wasActive=!0,this.onenter()),!0}catch(b){return!1}return this.wasActive&&(this.wasActive=!1,this.onexit()),!1},Object.prototype.__defineGetter__?this.__defineGetter__("active",this.isActive):Object.defineProperty&&Object.defineProperty(this,"active",{get:this.isActive}),this.toString=function(){return"TextTrackCue:"+this.id+"\n"+String(this.text)},this.onenter=function(){},this.onexit=function(){}},i.TextTrackCueList=function(a){this.track=a instanceof i.TextTrack?a:null,this.getCueById=function(a){return this.filter(function(b){return b.id===a})[0]},this.loadCues=function(a){for(var b=0;b<a.length;b++)a[b].track=this.track,Array.prototype.push.call(this,a[b])},this.addCue=function(a){if(!(a&&a instanceof i.TextTrackCue))throw new Error("The argument is null or not an instance of TextTrackCue.");if(a.track!==this.track&&a.track)throw new Error("This cue is associated with a different track!");Array.prototype.push.call(this,a)},this.toString=function(){return"[TextTrackCueList]"}},i.TextTrackCueList.prototype=[],i.ActiveTextTrackCueList=function(a,b){this.refreshCues=function(){if(a.length){var c=this,d=!1,e=[].slice.call(this,0);if(this.length=0,a.forEach(function(a){a.active&&(c.push(a),c[c.length-1]!==e[c.length-1]&&(d=!0))}),d)try{b.oncuechange()}catch(f){}}},this.toString=function(){return"[ActiveTextTrackCueList]"},this.refreshCues()},i.ActiveTextTrackCueList.prototype=new i.TextTrackCueList(null),i.rebuildCaptions=function(a){var b=a._textTracks||[],c=a.currentTime,d=[],e=!1,f=[],g=[];if(b.forEach(function(a){a.mode===i.TextTrack.SHOWING&&a.readyState===i.TextTrack.LOADED&&(g=[].slice.call(a.activeCues,0),g=g.sort(function(a,b){return a.startTime>b.startTime?-1:1}),d=d.concat(g))}),f=d.map(function(a){return a.track.id+"."+a.id+":"+a.text.toString(c).length}),e=!i.compareArray(f,a._captionator_previousActiveCues),e||a._captionator_dirtyBit){a._captionator_dirtyBit=!1,a._captionator_availableCueArea=null,a._captionator_previousActiveCues=f,i.styleCueCanvas(a);var h=[].concat([].slice.call(a._containerObject.getElementsByTagName("div"),0));h.forEach(function(a){a.cueObject&&!a.cueObject.active&&(a.cueObject.rendered=!1,a.cueObject.domNode=null,a.parentElement.removeChild(a))}),d.forEach(function(b){var d,e;"metadata"!==b.track.kind&&b.mode!==i.TextTrack.HIDDEN&&(b.rendered?(d=b.domNode,e=d.getElementsByClassName("captionator-cue-inner")[0],b.text.toString(c)!==d.currentText&&(d.currentText=b.text.toString(c),e.innerHTML=d.currentText,e.spanified=!1)):(d=document.createElement("div"),e=document.createElement("span"),e.className="captionator-cue-inner",d.id=String(b.id).length?b.id:i.generateID(),d.className="captionator-cue",d.appendChild(e),d.cueObject=b,b.domNode=d,d.setAttribute("lang",b.track.language),d.currentText=b.text.toString(c),e.innerHTML=i.mtvnProcessOutput(d.currentText),b.rendered=!0,a._containerObject.appendChild(d)),"descriptions"!==b.track.kind&&i.styleCue(d,b,a))})}},i.mtvnProcessOutput=function(a){if(!a)return"";a=a.replace("<br>","<br/>").replace("</br>","").replace("<br />","<br/>");var b=a.split("<br/>");if(b.length>0){for(var c=b.length;c--;)b[c]='<span style="background-color:'+h+';padding:2px 9px 4px 10px;">'+b[c]+"</span>";a=b.join("<br/>")}return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")},i.mtvnCaptionify=function(a,b){this.captionify(a,b,{sizeCuesByTextBoundingBox:!0,sanitiseCueHTML:!0,ignoreWhitespace:!0,forceCaptionify:!0})},i.captionify=function(a,f,g){g=g?g:{},g.minimumFontSize&&"number"==typeof g.minimumFontSize&&(b=g.minimumFontSize),g.minimumLineHeight&&"number"==typeof g.minimumLineHeight&&(c=g.minimumLineHeight),g.fontSizeVerticalPercentage&&"number"==typeof g.fontSizeVerticalPercentage&&(d=g.fontSizeVerticalPercentage),g.lineHeightRatio&&"number"!=typeof g.lineHeightRatio&&(e=g.lineHeightRatio),i.addTextTrack=function(b,c,d,e,f,g,h){var j;return b="string"==typeof b?b:"",d="string"==typeof d?d:"",e="string"==typeof e?e:"",h="boolean"==typeof h?h:!1,j=new i.TextTrack(b,c,d,e,f,null),j?(a._textTracks instanceof Array||(a._textTracks=[]),a._textTracks.push(j),j):!1},i.processVideoElement(a,g)},i.parseCaptions=function(a,b){b=b instanceof Object?b:{};var c="",d=[],e="",f=[],g=/^(\d{2})?:?(\d{2}):(\d{2})\.(\d+)\,(\d{2})?:?(\d{2}):(\d{2})\.(\d+)\s*(.*)/,h=/^(\d+)?:?(\d{2}):(\d{2})\.(\d+)\,(\d+)?:?(\d{2}):(\d{2})\.(\d+)\s*(.*)/,k=/^(\d{2})?:?(\d{2}):(\d{2})[\.\,](\d+)\s+\-\-\>\s+(\d{2})?:?(\d{2}):(\d{2})[\.\,](\d+)\s*(.*)/,l=/(\d{2})?:?(\d{2}):(\d{2})[\.\,](\d+)/,m=/^([\d\.]+)\s+\+([\d\.]+)\s*(.*)/,n=/^\[(\d{2})?:?(\d{2})\:(\d{2})\.(\d{2,3})\]\s*(.*?)$/,o=/^(DEFAULTS|DEFAULT)\s+\-\-\>\s+(.*)/g,p=/^(STYLE|STYLES)\s+\-\-\>\s*\n([\s\S]*)/g,q=/^(COMMENT|COMMENTS)\s+\-\-\>\s+(.*)/g,r=/<tt\s+xml/gi,s=/^(\d{2})?:?(\d{2}):(\d{2})\.(\d+)/;if(a){var t=function(a){var c,d,e,f,g,h=new i.CaptionatorCueStructure(a,b),k=[],m=[],n=0,o=function(a){return!!a.replace(/[^a-z0-9]+/gi,"").length};k=a.split(/(<\/?[^>]+>)/gi),a=j(k),e=h;for(c in k)if(k.hasOwnProperty(c))if(d=k[c],"<"===d.substr(0,1)){if("/"===d.substr(1,1)){var p=d.substr(2).split(/[\s>]+/g)[0];if(m.length>0){var q=0;for(n=m.length-1;n>=0;n--){var r=m[n][m[n].length-1];if(q=n,r.token===p)break}e=m[q],m=m.slice(0,q)}}else if(d.substr(1).match(l)||d.match(/^<v\s+[^>]+>/i)||d.match(/^<c[a-z0-9\-\_\.]+>/)||d.match(/^<(b|i|u|ruby|rt)>/)||b.sanitiseCueHTML!==!1){var s={token:d.replace(/[<\/>]+/gi,"").split(/[\s\.]+/)[0],rawToken:d,children:[]};"v"===s.token?s.voice=d.match(/^<v\s*([^>]+)>/i)[1]:"c"===s.token?s.classes=d.replace(/[<\/>\s]+/gi,"").split(/[\.]+/gi).slice(1).filter(o):(f=s.rawToken.match(l))&&(h.isTimeDependent=!0,g=f.slice(1),s.timeIn=parseInt(60*60*(g[0]||0),10)+parseInt(60*(g[1]||0),10)+parseInt(g[2]||0,10)+parseFloat("0."+(g[3]||0))),e.push(s),m.push(e),e=s.children}}else b.sanitiseCueHTML!==!1&&(d=d.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\&/g,"&amp;"),b.ignoreWhitespace||(d=d.replace(/\n+/g,"<br />"))),e.push(d);return h},u=function(a,d){var j,l,r,s,u,v,w,x,y,z,A="";if(x=o.exec(a))return f=x.slice(2).join(""),f=f.split(/\s+/g).filter(function(a){return a&&!!a.length}),null;if(x=p.exec(a))return e+=x[x.length-1],null;if(x=q.exec(a))return null;for(j="LRC"===c?[a.substr(0,a.indexOf("]")+1),a.substr(a.indexOf("]")+1)]:a.split(/\n/g);!j[0].replace(/\s+/gi,"").length&&j.length>0;)j.shift();for(w=j[0].match(/^\s*[a-z0-9\-]+\s*$/gi)?String(j.shift().replace(/\s*/gi,"")):d,v=0;v<j.length;v++){var B=j[v];(y=k.exec(B))||(y=g.exec(B))||(y=h.exec(B))?(u=y.slice(1),l=parseInt(60*60*(u[0]||0),10)+parseInt(60*(u[1]||0),10)+parseInt(u[2]||0,10)+parseFloat("0."+(u[3]||0)),r=parseInt(60*60*(u[4]||0),10)+parseInt(60*(u[5]||0),10)+parseInt(u[6]||0,10)+parseFloat("0."+(u[7]||0)),u[8]&&(A=u[8])):(y=m.exec(B))?(u=y.slice(1),l=parseFloat(u[0]),r=l+parseFloat(u[1]),u[2]&&(A=u[2])):(y=n.exec(B))&&(u=y.slice(1,y.length-1),l=parseInt(60*60*(u[0]||0),10)+parseInt(60*(u[1]||0),10)+parseInt(u[2]||0,10)+parseFloat("0."+(u[3]||0)),r=l),j=j.slice(0,v).concat(j.slice(v+1));break}if(!l&&!r)return null;var C=f.reduce(function(a,b){return a[b.split(":")[0]]=b.split(":")[1],a},{});C=A.split(/\s+/g).filter(function(a){return a&&!!a.length}).reduce(function(a,b){return a[b.split(":")[0]]=b.split(":")[1],a},C),A="";for(var D in C)C.hasOwnProperty(D)&&(A+=A.length?" ":"",A+=D+":"+C[D]);return s=b.processCueHTML===!1?j.join("\n"):t(j.join("\n")),z=new i.TextTrackCue(w,l,r,s,A,!1,null),z.styleData=e,z},v=function(a){var b,c=0;return"string"!=typeof a?0:((b=s.exec(a))&&(b=b.slice(1),c=parseInt(60*60*(b[0]||0),10)+parseInt(60*(b[1]||0),10)+parseInt(b[2]||0,10)+parseFloat("0."+(b[3]||0))),c)},w=function(a,c){var d,e=0,f=0,g=String(a.getAttribute("begin")),h=String(a.getAttribute("end")),j=a.getAttribute("id")||c;return e=v(g),f=v(h),d=b.processCueHTML===!1?a.innerHTML:t(a.innerHTML),new i.TextTrackCue(j,e,f,d,{},!1,null)};if(d=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.exec(a)){var x=document.createElement("ttml");a=a.replace(/<head(.|\n|\r)*head>/gim,""),x.innerHTML=a;var y=[].slice.call(x.querySelectorAll("[begin],[end]"),0),z=y.map(w);return z}return a.split(/\n+/g).reduce(function(a,b){return a||!!n.exec(b)},!1)?(d=d.split(/\n+/g),c="LRC"):d=d.split(/\n\n+/g),d=d.filter(function(a){return a.match(/^WEBVTT(\s*FILE)?/gi)?(c="WebVTT",!1):a.replace(/\s*/gi,"").length?!0:!1}).map(u).filter(function(a){return null!==a?!0:!1}),"LRC"===c&&(d.forEach(function(a,b){var c,e=0;b>0&&(e=a.startTime,c=d[--b],c.endTime<e&&(c.endTime=e))}),d=d.filter(function(a){return a.text.toString().replace(/\s*/,"").length>0?!0:!1})),d}throw new Error("Required parameter captionData not supplied.")},i.processVideoElement=function(a,b){if(b=b instanceof Object?b:{},!a.captioned){a._captionatorOptions=b,a.className+=(a.className.length?" ":"")+"captioned",a.captioned=!0,0===a.id.length&&(a.id=i.generateID());var c=a._trackConfig,d=i.addTextTrack(c.id||i.generateID(),c.kind,c.label,c.srclang,c.src,c.type);d.onerror=c.onError,c.track=d,d.videoElement=a,d.internalDefault=!0,d.mode=i.TextTrack.SHOWING,a.addEventListener("timeupdate",function(a){var c=a.target;try{c._textTracks.forEach(function(a){a.activeCues.refreshCues.apply(a.activeCues)})}catch(d){}b.renderer instanceof Function?b.renderer.call(i,c):i.rebuildCaptions(c)},!1),window.addEventListener("resize",function(){a._captionator_dirtyBit=!0,i.rebuildCaptions(a)},!1),b.enableHighResolution===!0&&window.setInterval(function(){try{a._textTracks.forEach(function(a){a.activeCues.refreshCues.apply(a.activeCues)})}catch(c){}b.renderer instanceof Function?b.renderer.call(i,a):i.rebuildCaptions(a)},20)}return a},i.getNodeMetrics=function(a){var b=window.getComputedStyle(a,null),c=a,d=a.offsetTop,e=a.offsetLeft,f=a,g=0,h=0;for(f=parseInt(b.getPropertyValue("width"),10),g=parseInt(b.getPropertyValue("height"),10);c=c.offsetParent;)d+=c.offsetTop,e+=c.offsetLeft;if(a.hasAttribute("controls")){var i=navigator.userAgent.toLowerCase();-1!==i.indexOf("chrome")?h=32:-1!==i.indexOf("opera")?h=25:-1!==i.indexOf("firefox")?h=28:-1!==i.indexOf("ie 9")||-1!==i.indexOf("ipad")?h=44:-1!==i.indexOf("safari")&&(h=25)}else if(a._captionatorOptions){var j=a._captionatorOptions;j.controlHeight&&(h=parseInt(j.controlHeight,10))}return{left:e,top:d,width:f,height:g,controlHeight:h}},i.applyStyles=function(a,b){for(var c in b)({}).hasOwnProperty.call(b,c)&&(a.style[c]=b[c])},i.checkDirection=function(a){var b="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿Ⰰ-﬜﷾-﹯﻽-￿",c="֑-߿יִ-﷽ﹰ-ﻼ",d=new RegExp("^[^"+c+"]*["+b+"]"),e=new RegExp("^[^"+b+"]*["+c+"]");return e.test(a)?"rtl":d.test(a)?"ltr":""},i.styleCue=function(a,f,g){var h,j,k,l,m,n,o,p,q,r,s,t,u,v,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=g._captionatorOptions||{},L=50,M=0,N=0,O=!0,P="";f.track.language;var Q=function(a){if(a.spanified)return a.characterCount;var b,c,d,e,f=function(a){return!!a.length},g="<span class='captionator-cue-character'>",h=0,j=function(a){h++,i.applyStyles(a,{display:"block",lineHeight:"auto",height:l+"px",width:r+"px",textAlign:"center"})};for(b in a.childNodes)a.childNodes.hasOwnProperty(b)&&!a.childNodes[b].nospan&&(c=a.childNodes[b],3===c.nodeType?(e=document.createDocumentFragment(),d=c.nodeValue,e.appendChild(document.createElement("span")),e.childNodes[0].innerHTML=g+d.split(/(.)/).filter(f).join("</span>"+g)+"</span>",[].slice.call(e.querySelectorAll("span.captionator-cue-character"),0).forEach(j),c.parentNode.replaceChild(e,c)):1===a.childNodes[b].nodeType&&(h+=Q(a.childNodes[b])));return a.characterCount=h,a.spanified=!0,h};if(u=i.getNodeMetrics(g),g._captionator_availableCueArea||(g._captionator_availableCueArea={bottom:u.height-u.controlHeight,right:u.width,top:0,left:0,height:u.height-u.controlHeight,width:u.width}),"horizontal"===f.direction&&(i.applyStyles(a,{width:"auto",position:"static",display:"inline-block",padding:"1em"}),M=parseInt(a.offsetWidth,10),N=Math.floor(100*(M/g._captionator_availableCueArea.width)),N=100>=N?N:100),k=72*(u.height*(d/100)/96),k=k>=b?k:b,l=Math.floor(96*(k/72)),m=Math.floor(k*e),m=m>c?m:c,q=Math.ceil(96*(m/72)),r=q,q*Math.floor(u.height/q)<u.height&&(q=Math.floor(u.height/Math.floor(u.height/q)),m=Math.ceil(72*(q/96))),q*Math.floor(u.width/q)<u.width&&(r=Math.ceil(u.width/Math.floor(u.width/q))),o=Math.floor(g._captionator_availableCueArea.height/q),p=Math.floor(g._captionator_availableCueArea.width/r),0===parseFloat(String(f.size).replace(/[^\d\.]/gi,""))?K.sizeCuesByTextBoundingBox===!0?h=N:(h=100,O=!1):(O=!1,h=parseFloat(String(f.size).replace(/[^\d\.]/gi,"")),h=100>=h?h:100),A="horizontal"===f.direction?Math.floor(.01*u.width):0,B="horizontal"===f.direction?0:Math.floor(.01*u.height),"auto"===f.linePosition?f.linePosition="horizontal"===f.direction?o:p:String(f.linePosition).match(/\%/)&&(f.snapToLines=!1,f.linePosition=parseFloat(String(f.linePosition).replace(/\%/gi,""))),"horizontal"===f.direction)z=q,"auto"!==f.textPosition&&O&&(L=parseFloat(String(f.textPosition).replace(/[^\d\.]/gi,"")),h-L>N?h-=L:h=N),y=f.snapToLines===!0?g._captionator_availableCueArea.width*(h/100):u.width*(h/100),"auto"===f.textPosition?w=(g._captionator_availableCueArea.right-y)/2+g._captionator_availableCueArea.left:(L=parseFloat(String(f.textPosition).replace(/[^\d\.]/gi,"")),w=(g._captionator_availableCueArea.right-y)*(L/100)+g._captionator_availableCueArea.left),f.snapToLines===!0?x=(o-1)*q+g._captionator_availableCueArea.top:(n=u.controlHeight+q+2*B,x=(u.height-n)*(f.linePosition/100));else{if(x=g._captionator_availableCueArea.top,w=g._captionator_availableCueArea.right-r,y=r,z=g._captionator_availableCueArea.height*(h/100),D=Q(a),E=[].slice.call(a.querySelectorAll("span.captionator-cue-character"),0),C=Math.floor((z-2*B)/l),y=Math.ceil(D/C)*r,F=Math.ceil(D/C),G=D-C*(F-1),H=G*l,f.snapToLines===!0)w="vertical-lr"===f.direction?g._captionator_availableCueArea.left:g._captionator_availableCueArea.right-y;else{var R=y+2*A;w="vertical-lr"===f.direction?(u.width-R)*(f.linePosition/100):u.width-R-(u.width-R)*(f.linePosition/100)}"auto"===f.textPosition?x=(g._captionator_availableCueArea.bottom-z)/2+g._captionator_availableCueArea.top:(f.textPosition=parseFloat(String(f.textPosition).replace(/[^\d\.]/gi,"")),x=(g._captionator_availableCueArea.bottom-z)*(f.textPosition/100)+g._captionator_availableCueArea.top),I=0,J=0,s=0,t=0,E.forEach(function(a){s="vertical-lr"===f.direction?r*I:y-r*(I+1),"start"===f.alignment||"start"!==f.alignment&&F-1>I?t=J*l+B:"end"===f.alignment?t=J*l-l+(z+2*B-H):"middle"===f.alignment&&(t=(z-2*B-H)/2+J*l),a.setAttribute("aria-hidden","true"),i.applyStyles(a,{position:"absolute",top:t+"px",left:s+"px"}),J>=C-1?(J=0,I++):J++}),a.accessified||(P=f.text.getPlain(g.currentTime),v=document.createElement("div"),v.innerHTML=P,v.nospan=!0,a.appendChild(v),a.accessified=!0,i.applyStyles(v,{position:"absolute",overflow:"hidden",width:"1px",height:"1px",opacity:"0",textIndent:"-999em"}))}if("horizontal"===f.direction&&(j="rtl"===i.checkDirection(String(f.text))?{start:"right",middle:"center",end:"left"}[f.alignment]:{start:"left",middle:"center",end:"right"}[f.alignment]),i.applyStyles(a,{position:"absolute",overflow:"hidden",width:y+"px",height:z+"px",top:x+"px",left:w+"px",padding:B+"px "+A+"px",textAlign:j,direction:i.checkDirection(String(f.text)),lineHeight:m+"pt",boxSizing:"border-box"}),"vertical"===f.direction||"vertical-lr"===f.direction)w-g._captionator_availableCueArea.left-g._captionator_availableCueArea.left>=g._captionator_availableCueArea.right-(w+y)?g._captionator_availableCueArea.right=w:g._captionator_availableCueArea.left=w+y,g._captionator_availableCueArea.width=g._captionator_availableCueArea.right-g._captionator_availableCueArea.left;else{if(a.scrollHeight>1.2*a.offsetHeight)if(f.snapToLines){for(var S=0;a.scrollHeight>1.2*a.offsetHeight;)z+=q,a.style.height=z+"px",S++;x-=S*q,a.style.top=x+"px"}else z=a.scrollHeight+B,n=u.controlHeight+z+2*B,x=(u.height-n)*(f.linePosition/100),a.style.height=z+"px",a.style.top=x+"px";x-g._captionator_availableCueArea.top-g._captionator_availableCueArea.top>=g._captionator_availableCueArea.bottom-(x+z)&&g._captionator_availableCueArea.bottom>x?g._captionator_availableCueArea.bottom=x:g._captionator_availableCueArea.top<x+z&&(g._captionator_availableCueArea.top=x+z),g._captionator_availableCueArea.height=g._captionator_availableCueArea.bottom-g._captionator_availableCueArea.top}},i.updateCCPrefs=function(b,c){c=c||{},f=c.color||f,a=c.fontSize||a,h=c.backgroundColor||h,g=c.fontFamily||g,i.styleCueCanvas(b)},i.styleCueCanvas=function(a){var h,j,k,l;a._containerObject&&(k=a._containerObject,l=k.id);var m=i.getNodeMetrics(a);h=72*(m.height*(d/100)/96),h=h>=b?h:b,j=Math.floor(h*e),j=j>c?j:c,i.applyStyles(k,{position:"absolute",overflow:"hidden",zIndex:100,width:"100%",height:"100%","-webkit-transition":"-webkit-transform 0.5s ease",top:m.top+"px",left:m.left+"px",color:f,fontFamily:g,fontSize:h+"pt",lineHeight:j+"pt",boxSizing:"border-box"})},i.createDOMException=function(a,b,c){try{document.querySelectorAll("div/[]")}catch(d){var e=function(a,b,c){this.code=a,this.message=b,this.name=c};return e.prototype=d,new e(a,b,c)}},i.compareArray=function(a,b){if(!(a instanceof Array&&b instanceof Array))return!1;if(a.length!==b.length)return!1;for(var c in a)if(a.hasOwnProperty(c)&&a[c]!==b[c])return!1;return!0},i.generateID=function(a){var b="";for(a=a?a:10;b.length<a;)b+=String.fromCharCode(65+Math.floor(26*Math.random()));return"captionator"+b}}();