!function(){"use strict";var a=10,b=16,c=5.3,d=1.5,e={containerCSS:{color:"white",fontFamily:"serif, sans-serif, monospace",backgroundColor:"black"},testCSS:{}},f={};window.captionator=f;var g=function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];if(0===d.indexOf("<")){var e=d.slice(0,d.indexOf(" ")),f="";if(-1!==d.indexOf('tts:fontstyle="italic"')&&(f+="font-style:italic;"),-1!==d.indexOf('tts:fontweight="bold"')&&(f+="font-weight:bold;"),-1!==d.indexOf("tts:color")){var g=d.match(/color=\"(.*)\"/);g.length>1&&(f+="color:"+g[1]+";")}f&&(d=e+' style="'+f+'">'),a[b]=d}}return a};f.CaptionatorCueStructure=function(a,b){var c=this;this.isTimeDependent=!1,this.cueSource=a,this.options=b,this.processedCue=null,this.toString=function(d){if(b.processCueHTML!==!1){var e=function(a,b){if(null===c.processedCue){var f,g,h="";for(f in a)f.match(/^\d+$/)&&a.hasOwnProperty(f)&&(g=a[f],g instanceof Object&&g.children&&g.children.length?"v"===g.token?h+='<q data-voice="'+g.voice.replace(/[\"]/g,"")+"\" class='voice speaker-"+g.voice.replace(/[^a-z0-9]+/gi,"-").toLowerCase()+" webvtt-span' title=\""+g.voice.replace(/[\"]/g,"")+'">'+e(g.children,b+1)+"</q>":"c"===g.token?h+="<span class='webvtt-span webvtt-class-span "+g.classes.join(" ")+"'>"+e(g.children,b+1)+"</span>":g.timeIn>0?null===d||void 0===d||d>0&&d>=g.timeIn?h+="<span class='webvtt-span webvtt-timestamp-span' data-timestamp='"+g.token+"' data-timestamp-seconds='"+g.timeIn+"'>"+e(g.children,b+1)+"</span>":d<g.timeIn&&(h+="<span class='webvtt-span webvtt-timestamp-span webvtt-cue-future' aria-hidden='true' style='opacity: 0;' data-timestamp='"+g.token+"' data-timestamp-seconds='"+g.timeIn+"'>"+e(g.children,b+1)+"</span>"):h+=g.rawToken+e(g.children,b+1)+"</"+g.token+">":(g instanceof String||"string"==typeof g||"number"==typeof g)&&(h+=g));return c.isTimeDependent||0!==b||(c.processedCue=h),h}return c.processedCue};return e(this,0)}return a},this.getPlain=function(c){if(b.processCueHTML!==!1){var d=function(a,b){var e,f,g="";for(e in a)e.match(/^\d+$/)&&a.hasOwnProperty(e)&&(f=a[e],f instanceof Object&&f.children&&f.children.length?f.timeIn>0?(null===c||void 0===c||c>0&&c>=f.timeIn)&&(g+=d(f.children,b+1)):g+=d(f.children,b+1):(f instanceof String||"string"==typeof f||"number"==typeof f)&&(g+=f));return g};return d(this,0)}return a.replace(/<[^>]*>/gi,"")}},f.CaptionatorCueStructure.prototype=[],f.TextTrack=function(a,b,c,d,e,g){this.onload=function(){},this.onerror=function(){},this.oncuechange=function(){},this.id=a||"",this.internalMode=f.TextTrack.OFF,this.cues=new f.TextTrackCueList(this),this.activeCues=new f.ActiveTextTrackCueList(this.cues,this),this.kind=b||"subtitles",this.label=c||"",this.language=d||"",this.src=e||"",this.readyState=f.TextTrack.NONE,this.internalDefault=g||!1,this.getMode=function(){return this.internalMode},this.setMode=function(a){var b=[f.TextTrack.OFF,f.TextTrack.HIDDEN,f.TextTrack.SHOWING];if(-1===b.indexOf(a))throw new Error("Illegal mode value for track: "+a);a!==this.internalMode&&(this.internalMode=a,this.readyState===f.TextTrack.NONE&&this.src.length>0&&a>f.TextTrack.OFF&&this.loadTrack(this.src,null),this.videoElement._captionator_dirtyBit=!0,f.rebuildCaptions(this.videoElement),a===f.TextTrack.OFF&&(this.cues.length=0,this.readyState=f.TextTrack.NONE))},this.getDefault=function(){return this.internalDefault},Object.prototype.__defineGetter__?(this.__defineGetter__("mode",this.getMode),this.__defineSetter__("mode",this.setMode),this.__defineGetter__("default",this.getDefault)):Object.defineProperty&&(Object.defineProperty(this,"mode",{get:this.getMode,set:this.setMode}),Object.defineProperty(this,"default",{get:this.getDefault})),this.loadTrack=function(a,b){var c,d=new XMLHttpRequest;if(this.readyState===f.TextTrack.LOADED)b instanceof Function&&b(c);else{this.src=a,this.readyState=f.TextTrack.LOADING;var e=this;d.open("GET",a,!0),d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){var a=e.videoElement._captionatorOptions||{};"metadata"===e.kind&&(a.processCueHTML=!1,a.sanitiseCueHTML=!1),c=f.parseCaptions(d.responseText,a),e.readyState=f.TextTrack.LOADED,e.cues.loadCues(c),e.activeCues.refreshCues.apply(e.activeCues),e.videoElement._captionator_dirtyBit=!0,f.rebuildCaptions(e.videoElement),e.onload.call(this),b instanceof Function&&b.call(e,c)}else e.readyState=f.TextTrack.ERROR,e.onerror()};try{d.send(null)}catch(g){e.readyState=f.TextTrack.ERROR,e.onerror(g)}}},this.addCue=function(a){if(!(a&&a instanceof f.TextTrackCue))throw new Error("The argument is null or not an instance of TextTrackCue.");this.cues.addCue(a)},this.removeCue=function(){}},f.TextTrack.NONE=0,f.TextTrack.LOADING=1,f.TextTrack.LOADED=2,f.TextTrack.ERROR=3,f.TextTrack.OFF=0,f.TextTrack.HIDDEN=1,f.TextTrack.SHOWING=2,f.TextTrackCue=function(a,b,c,d,e,g,h){if(this.id=a,this.track=h instanceof f.TextTrack?h:null,this.startTime=parseFloat(b),this.endTime=parseFloat(c)>=this.startTime?parseFloat(c):this.startTime,this.text="string"==typeof d||d instanceof f.CaptionatorCueStructure?d:"",this.settings="string"==typeof e?e:"",this.intSettings={},this.pauseOnExit=!!g,this.wasActive=!1,this.direction="horizontal",this.snapToLines=!0,this.linePosition="auto",this.textPosition=50,this.size=0,this.alignment="middle",this.settings.length){var i=this.intSettings,j=this;e=e.split(/\s+/).filter(function(a){return a.length>0}),e instanceof Array&&e.forEach(function(a){var b={D:"direction",L:"linePosition",T:"textPosition",A:"alignment",S:"size"};a=a.split(":"),b[a[0]]&&(i[b[a[0]]]=a[1]),b[a[0]]in j&&(j[b[a[0]]]=a[1])})}this.linePosition.match(/\%/)&&(this.snapToLines=!1),this.getCueAsSource=function(){return String(this.text)},this.getCueAsHTML=function(){var a=document.createDocumentFragment(),b=document.createElement("div");return b.innerHTML=String(this.text),Array.prototype.forEach.call(b.childNodes,function(b){a.appendChild(b.cloneNode(!0))}),a},this.isActive=function(){var a=0;if(this.track instanceof f.TextTrack&&(this.track.mode===f.TextTrack.SHOWING||this.track.mode===f.TextTrack.HIDDEN)&&this.track.readyState===f.TextTrack.LOADED)try{if(a=this.track.videoElement.currentTime,this.startTime<=a&&this.endTime>=a)return this.wasActive||(this.wasActive=!0,this.onenter()),!0}catch(b){return!1}return this.wasActive&&(this.wasActive=!1,this.onexit()),!1},Object.prototype.__defineGetter__?this.__defineGetter__("active",this.isActive):Object.defineProperty&&Object.defineProperty(this,"active",{get:this.isActive}),this.toString=function(){return"TextTrackCue:"+this.id+"\n"+String(this.text)},this.onenter=function(){},this.onexit=function(){}},f.TextTrackCueList=function(a){this.track=a instanceof f.TextTrack?a:null,this.getCueById=function(a){return this.filter(function(b){return b.id===a})[0]},this.loadCues=function(a){for(var b=0;b<a.length;b++)a[b].track=this.track,Array.prototype.push.call(this,a[b])},this.addCue=function(a){if(!(a&&a instanceof f.TextTrackCue))throw new Error("The argument is null or not an instance of TextTrackCue.");if(a.track!==this.track&&a.track)throw new Error("This cue is associated with a different track!");Array.prototype.push.call(this,a)},this.toString=function(){return"[TextTrackCueList]"}},f.TextTrackCueList.prototype=[],f.ActiveTextTrackCueList=function(a,b){this.refreshCues=function(){if(a.length){var c=this,d=!1,e=[].slice.call(this,0);if(this.length=0,a.forEach(function(a){a.active&&(c.push(a),c[c.length-1]!==e[c.length-1]&&(d=!0))}),d)try{b.oncuechange()}catch(f){}}},this.toString=function(){return"[ActiveTextTrackCueList]"},this.refreshCues()},f.ActiveTextTrackCueList.prototype=new f.TextTrackCueList(null),f.rebuildCaptions=function(a){var b=a._textTracks||[],c=a.currentTime,d=[],e=!1,g=[],h=[];if(b.forEach(function(a){a.mode===f.TextTrack.SHOWING&&a.readyState===f.TextTrack.LOADED&&(h=[].slice.call(a.activeCues,0),h=h.sort(function(a,b){return a.startTime>b.startTime?-1:1}),d=d.concat(h))}),g=d.map(function(a){return a.track.id+"."+a.id+":"+a.text.toString(c).length}),e=!f.compareArray(g,a._captionator_previousActiveCues),e||a._captionator_dirtyBit){a._captionator_dirtyBit=!1,a._captionator_availableCueArea=null,a._captionator_previousActiveCues=g,f.styleCueCanvas(a);var i=[].concat([].slice.call(a._containerObject.getElementsByTagName("div"),0));i.forEach(function(a){a.cueObject&&!a.cueObject.active&&(a.cueObject.rendered=!1,a.cueObject.domNode=null,a.parentElement.removeChild(a))}),d.forEach(function(b){var d,e;"metadata"!==b.track.kind&&b.mode!==f.TextTrack.HIDDEN&&(b.rendered?(d=b.domNode,e=d.getElementsByClassName("captionator-cue-inner")[0],b.text.toString(c)!==d.currentText&&(d.currentText=b.text.toString(c),e.innerHTML=d.currentText,e.spanified=!1)):(d=document.createElement("div"),e=document.createElement("span"),e.className="captionator-cue-inner",d.id=String(b.id).length?b.id:f.generateID(),d.className="captionator-cue",d.appendChild(e),d.cueObject=b,b.domNode=d,d.setAttribute("lang",b.track.language),d.currentText=b.text.toString(c),e.innerHTML=f.mtvnProcessOutput(d.currentText),b.rendered=!0,a._containerObject.appendChild(d),f.updateSpanStyles($(a._containerObject))),"descriptions"!==b.track.kind&&f.styleCue(d,b,a))})}},function(){function a(a){return a?(a=$(a).html(),a.replace(/<br>|<\/br>/gi,"\n")):""}var b=window.VTTCue||window.TextTrackCue;f.rebuildCaptionsVTT=function(c){var d=c._textTracks||[];d.forEach(function(d){if(!d.vttProcessed&&d.mode===f.TextTrack.SHOWING&&d.readyState===f.TextTrack.LOADED){d.vttProcessed=!0;var e=c.addTextTrack("captions");e.id=d.src,e.mode="disabled";try{d.cues.forEach(function(c){var d=a(c.text.toString()),f=new b(c.startTime,c.endTime,d);e.addCue(f)})}catch(g){console.error("error parsing ttml into vtt.",g)}}})}}(),f.mtvnProcessOutput=function(a){if(!a)return"";a=a.replace("<br/>","<br>").replace("</br>","").replace("<br />","<br/>"),a=a.replace("<br>","</span><br><span>");var b=a.split("<br>");return b.length>0&&($.each(b,function(a,c){b[a]='<span class="mtvn-cue"><span class="mtvn-cue-text">'+c+"</span></span>"}),a=b.join("<br>")),a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")},f.mtvnCaptionify=function(a,b){a.vtt&&(f.rebuildCaptions=f.rebuildCaptionsVTT),this.captionify(a,b,{sizeCuesByTextBoundingBox:!0,sanitiseCueHTML:!0,ignoreWhitespace:!0,forceCaptionify:!0})},f.captionify=function(e,g,h){h=h?h:{},h.minimumFontSize&&"number"==typeof h.minimumFontSize&&(a=h.minimumFontSize),h.minimumLineHeight&&"number"==typeof h.minimumLineHeight&&(b=h.minimumLineHeight),h.fontSizeVerticalPercentage&&"number"==typeof h.fontSizeVerticalPercentage&&(c=h.fontSizeVerticalPercentage),h.lineHeightRatio&&"number"!=typeof h.lineHeightRatio&&(d=h.lineHeightRatio),f.addTextTrack=function(a,b,c,d,g,h,i){var j;return a="string"==typeof a?a:"",c="string"==typeof c?c:"",d="string"==typeof d?d:"",i="boolean"==typeof i?i:!1,j=new f.TextTrack(a,b,c,d,g,null),j?(e._textTracks instanceof Array||(e._textTracks=[]),e._textTracks.push(j),j):!1},f.processVideoElement(e,h)},f.parseCaptions=function(a,b){b=b instanceof Object?b:{};var c="",d=[],e="",h=[],i=/^(\d{2})?:?(\d{2}):(\d{2})\.(\d+)\,(\d{2})?:?(\d{2}):(\d{2})\.(\d+)\s*(.*)/,j=/^(\d+)?:?(\d{2}):(\d{2})\.(\d+)\,(\d+)?:?(\d{2}):(\d{2})\.(\d+)\s*(.*)/,k=/^(\d{2})?:?(\d{2}):(\d{2})[\.\,](\d+)\s+\-\-\>\s+(\d{2})?:?(\d{2}):(\d{2})[\.\,](\d+)\s*(.*)/,l=/(\d{2})?:?(\d{2}):(\d{2})[\.\,](\d+)/,m=/^([\d\.]+)\s+\+([\d\.]+)\s*(.*)/,n=/^\[(\d{2})?:?(\d{2})\:(\d{2})\.(\d{2,3})\]\s*(.*?)$/,o=/^(DEFAULTS|DEFAULT)\s+\-\-\>\s+(.*)/g,p=/^(STYLE|STYLES)\s+\-\-\>\s*\n([\s\S]*)/g,q=/^(COMMENT|COMMENTS)\s+\-\-\>\s+(.*)/g,r=/<tt\s+xml/gi,s=/^(\d{2})?:?(\d{2}):(\d{2})\.(\d+)/;if(a){var t=function(a){var c,d,e,h,i,j=new f.CaptionatorCueStructure(a,b),k=[],m=[],n=0,o=function(a){return!!a.replace(/[^a-z0-9]+/gi,"").length};k=a.split(/(<\/?[^>]+>)/gi),a=g(k),e=j;for(c in k)if(k.hasOwnProperty(c))if(d=k[c],"<"===d.substr(0,1)){if("/"===d.substr(1,1)){var p=d.substr(2).split(/[\s>]+/g)[0];if(m.length>0){var q=0;for(n=m.length-1;n>=0;n--){var r=m[n][m[n].length-1];if(q=n,r.token===p)break}e=m[q],m=m.slice(0,q)}}else if(d.substr(1).match(l)||d.match(/^<v\s+[^>]+>/i)||d.match(/^<c[a-z0-9\-\_\.]+>/)||d.match(/^<(b|i|u|ruby|rt)>/)||b.sanitiseCueHTML!==!1){var s={token:d.replace(/[<\/>]+/gi,"").split(/[\s\.]+/)[0],rawToken:d,children:[]};"v"===s.token?s.voice=d.match(/^<v\s*([^>]+)>/i)[1]:"c"===s.token?s.classes=d.replace(/[<\/>\s]+/gi,"").split(/[\.]+/gi).slice(1).filter(o):(h=s.rawToken.match(l))&&(j.isTimeDependent=!0,i=h.slice(1),s.timeIn=parseInt(60*(i[0]||0)*60,10)+parseInt(60*(i[1]||0),10)+parseInt(i[2]||0,10)+parseFloat("0."+(i[3]||0))),e.push(s),m.push(e),e=s.children}}else b.sanitiseCueHTML!==!1&&(d=d.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\&/g,"&amp;"),b.ignoreWhitespace||(d=d.replace(/\n+/g,"<br />"))),e.push(d);return j},u=function(a,d){var g,l,r,s,u,v,w,x,y,z,A="";if(x=o.exec(a))return h=x.slice(2).join(""),h=h.split(/\s+/g).filter(function(a){return a&&!!a.length}),null;if(x=p.exec(a))return e+=x[x.length-1],null;if(x=q.exec(a))return null;for(g="LRC"===c?[a.substr(0,a.indexOf("]")+1),a.substr(a.indexOf("]")+1)]:a.split(/\n/g);!g[0].replace(/\s+/gi,"").length&&g.length>0;)g.shift();for(w=g[0].match(/^\s*[a-z0-9\-]+\s*$/gi)?String(g.shift().replace(/\s*/gi,"")):d,v=0;v<g.length;v++){var B=g[v];(y=k.exec(B))||(y=i.exec(B))||(y=j.exec(B))?(u=y.slice(1),l=parseInt(60*(u[0]||0)*60,10)+parseInt(60*(u[1]||0),10)+parseInt(u[2]||0,10)+parseFloat("0."+(u[3]||0)),r=parseInt(60*(u[4]||0)*60,10)+parseInt(60*(u[5]||0),10)+parseInt(u[6]||0,10)+parseFloat("0."+(u[7]||0)),u[8]&&(A=u[8])):(y=m.exec(B))?(u=y.slice(1),l=parseFloat(u[0]),r=l+parseFloat(u[1]),u[2]&&(A=u[2])):(y=n.exec(B))&&(u=y.slice(1,y.length-1),l=parseInt(60*(u[0]||0)*60,10)+parseInt(60*(u[1]||0),10)+parseInt(u[2]||0,10)+parseFloat("0."+(u[3]||0)),r=l),g=g.slice(0,v).concat(g.slice(v+1));break}if(!l&&!r)return null;var C=h.reduce(function(a,b){return a[b.split(":")[0]]=b.split(":")[1],a},{});C=A.split(/\s+/g).filter(function(a){return a&&!!a.length}).reduce(function(a,b){return a[b.split(":")[0]]=b.split(":")[1],a},C),A="";for(var D in C)C.hasOwnProperty(D)&&(A+=A.length?" ":"",A+=D+":"+C[D]);return s=b.processCueHTML===!1?g.join("\n"):t(g.join("\n")),z=new f.TextTrackCue(w,l,r,s,A,!1,null),z.styleData=e,z},v=function(a){var b,c=0;return"string"!=typeof a?0:((b=s.exec(a))&&(b=b.slice(1),c=parseInt(60*(b[0]||0)*60,10)+parseInt(60*(b[1]||0),10)+parseInt(b[2]||0,10)+parseFloat("0."+(b[3]||0))),c)},w=function(a,c){var d,e=0,g=0,h=String(a.getAttribute("begin")),i=String(a.getAttribute("end")),j=a.getAttribute("id")||c;return e=v(h),g=v(i),d=b.processCueHTML===!1?a.innerHTML:t(a.innerHTML),new f.TextTrackCue(j,e,g,d,{},!1,null)};if(d=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.exec(a)){var x=document.createElement("ttml");a=a.replace(/<head(.|\n|\r)*head>/gim,""),x.innerHTML=a;var y=[].slice.call(x.querySelectorAll("[begin],[end]"),0),z=y.map(w);return z}return a.split(/\n+/g).reduce(function(a,b){return a||!!n.exec(b)},!1)?(d=d.split(/\n+/g),c="LRC"):d=d.split(/\n\n+/g),d=d.filter(function(a){return a.match(/^WEBVTT(\s*FILE)?/gi)?(c="WebVTT",!1):a.replace(/\s*/gi,"").length?!0:!1}).map(u).filter(function(a){return null!==a?!0:!1}),"LRC"===c&&(d.forEach(function(a,b){var c,e=0;b>0&&(e=a.startTime,c=d[--b],c.endTime<e&&(c.endTime=e))}),d=d.filter(function(a){return a.text.toString().replace(/\s*/,"").length>0?!0:!1})),d}throw new Error("Required parameter captionData not supplied.")},f.processVideoElement=function(a,b){if(b=b instanceof Object?b:{},!a.captioned){a._captionatorOptions=b,a.className+=(a.className.length?" ":"")+"captioned",a.captioned=!0,0===a.id.length&&(a.id=f.generateID());var c=a._trackConfig,d=f.addTextTrack(c.id||f.generateID(),c.kind,c.label,c.srclang,c.src,c.type);d.onerror=c.onError,c.track=d,d.videoElement=a,d.internalDefault=!0,d.mode=f.TextTrack.SHOWING,a.addEventListener("timeupdate",function(a){var b=a.target;try{b._textTracks.forEach(function(a){a.activeCues.refreshCues.apply(a.activeCues)})}catch(c){}f.rebuildCaptions(b)},!1),a.vtt||window.addEventListener("resize",function(){a._captionator_dirtyBit=!0,f.rebuildCaptions(a)},!1),b.enableHighResolution===!0&&window.setInterval(function(){try{a._textTracks.forEach(function(a){a.activeCues.refreshCues.apply(a.activeCues)})}catch(b){}f.rebuildCaptions(a)},20)}return a},f.getNodeMetrics=function(a){var b=window.getComputedStyle(a,null),c=a,d=a.offsetTop,e=a.offsetLeft,f=a,g=0,h=0;for(f=parseInt(b.getPropertyValue("width"),10),g=parseInt(b.getPropertyValue("height"),10);c=c.offsetParent;)d+=c.offsetTop,e+=c.offsetLeft;if(a.hasAttribute("controls")){var i=navigator.userAgent.toLowerCase();-1!==i.indexOf("chrome")?h=32:-1!==i.indexOf("opera")?h=25:-1!==i.indexOf("firefox")?h=28:-1!==i.indexOf("ie 9")||-1!==i.indexOf("ipad")?h=44:-1!==i.indexOf("safari")&&(h=25)}else if(a._captionatorOptions){var j=a._captionatorOptions;j.controlHeight&&(h=parseInt(j.controlHeight,10))}return{left:e,top:d,width:f,height:g,controlHeight:h}},f.applyStyles=function(a,b){for(var c in b)({}).hasOwnProperty.call(b,c)&&(a.style[c]=b[c])},f.checkDirection=function(a){var b="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿Ⰰ-﬜﷾-﹯﻽-￿",c="֑-߿יִ-﷽ﹰ-ﻼ",d=new RegExp("^[^"+c+"]*["+b+"]"),e=new RegExp("^[^"+b+"]*["+c+"]");return e.test(a)?"rtl":d.test(a)?"ltr":""},f.styleCue=function(e,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=h._captionatorOptions||{},L=50,M=0,N=0,O=!0,P="",Q=function(a){if(a.spanified)return a.characterCount;var b,c,d,e,g=function(a){return!!a.length},h="<span class='captionator-cue-character'>",i=0,j=function(a){i++,f.applyStyles(a,{display:"block",lineHeight:"auto",height:l+"px",width:r+"px",textAlign:"center"})};for(b in a.childNodes)a.childNodes.hasOwnProperty(b)&&!a.childNodes[b].nospan&&(c=a.childNodes[b],3===c.nodeType?(e=document.createDocumentFragment(),d=c.nodeValue,e.appendChild(document.createElement("span")),e.childNodes[0].innerHTML=h+d.split(/(.)/).filter(g).join("</span>"+h)+"</span>",[].slice.call(e.querySelectorAll("span.captionator-cue-character"),0).forEach(j),c.parentNode.replaceChild(e,c)):1===a.childNodes[b].nodeType&&(i+=Q(a.childNodes[b])));return a.characterCount=i,a.spanified=!0,i};if(u=f.getNodeMetrics(h),h._captionator_availableCueArea||(h._captionator_availableCueArea={bottom:u.height-u.controlHeight,right:u.width,top:0,left:0,height:u.height-u.controlHeight,width:u.width}),"horizontal"===g.direction&&(f.applyStyles(e,{width:"auto",position:"static",display:"inline-block",padding:"1em"}),M=parseInt(e.offsetWidth,10),N=Math.floor(M/h._captionator_availableCueArea.width*100),N=100>=N?N:100),k=u.height*(c/100)/96*72,k=k>=a?k:a,l=Math.floor(k/72*96),m=Math.floor(k*d),m=m>b?m:b,q=Math.ceil(m/72*96),r=q,q*Math.floor(u.height/q)<u.height&&(q=Math.floor(u.height/Math.floor(u.height/q)),m=Math.ceil(q/96*72)),q*Math.floor(u.width/q)<u.width&&(r=Math.ceil(u.width/Math.floor(u.width/q))),o=Math.floor(h._captionator_availableCueArea.height/q),p=Math.floor(h._captionator_availableCueArea.width/r),0===parseFloat(String(g.size).replace(/[^\d\.]/gi,""))?K.sizeCuesByTextBoundingBox===!0?i=N:(i=100,O=!1):(O=!1,i=parseFloat(String(g.size).replace(/[^\d\.]/gi,"")),i=100>=i?i:100),A="horizontal"===g.direction?Math.floor(.01*u.width):0,B="horizontal"===g.direction?0:Math.floor(.01*u.height),"auto"===g.linePosition?g.linePosition="horizontal"===g.direction?o:p:String(g.linePosition).match(/\%/)&&(g.snapToLines=!1,g.linePosition=parseFloat(String(g.linePosition).replace(/\%/gi,""))),"horizontal"===g.direction)z=q,"auto"!==g.textPosition&&O&&(L=parseFloat(String(g.textPosition).replace(/[^\d\.]/gi,"")),i-L>N?i-=L:i=N),y=g.snapToLines===!0?h._captionator_availableCueArea.width*(i/100):u.width*(i/100),"auto"===g.textPosition?w=(h._captionator_availableCueArea.right-y)/2+h._captionator_availableCueArea.left:(L=parseFloat(String(g.textPosition).replace(/[^\d\.]/gi,"")),w=(h._captionator_availableCueArea.right-y)*(L/100)+h._captionator_availableCueArea.left),g.snapToLines===!0?x=(o-1)*q+h._captionator_availableCueArea.top:(n=u.controlHeight+q+2*B,x=(u.height-n)*(g.linePosition/100));else{if(x=h._captionator_availableCueArea.top,w=h._captionator_availableCueArea.right-r,y=r,z=h._captionator_availableCueArea.height*(i/100),D=Q(e),E=[].slice.call(e.querySelectorAll("span.captionator-cue-character"),0),C=Math.floor((z-2*B)/l),y=Math.ceil(D/C)*r,F=Math.ceil(D/C),G=D-C*(F-1),H=G*l,g.snapToLines===!0)w="vertical-lr"===g.direction?h._captionator_availableCueArea.left:h._captionator_availableCueArea.right-y;else{var R=y+2*A;w="vertical-lr"===g.direction?(u.width-R)*(g.linePosition/100):u.width-R-(u.width-R)*(g.linePosition/100)}"auto"===g.textPosition?x=(h._captionator_availableCueArea.bottom-z)/2+h._captionator_availableCueArea.top:(g.textPosition=parseFloat(String(g.textPosition).replace(/[^\d\.]/gi,"")),x=(h._captionator_availableCueArea.bottom-z)*(g.textPosition/100)+h._captionator_availableCueArea.top),I=0,J=0,s=0,t=0,E.forEach(function(a){s="vertical-lr"===g.direction?r*I:y-r*(I+1),"start"===g.alignment||"start"!==g.alignment&&F-1>I?t=J*l+B:"end"===g.alignment?t=J*l-l+(z+2*B-H):"middle"===g.alignment&&(t=(z-2*B-H)/2+J*l),a.setAttribute("aria-hidden","true"),f.applyStyles(a,{position:"absolute",top:t+"px",left:s+"px"}),J>=C-1?(J=0,I++):J++}),e.accessified||(P=g.text.getPlain(h.currentTime),v=document.createElement("div"),v.innerHTML=P,v.nospan=!0,e.appendChild(v),e.accessified=!0,f.applyStyles(v,{position:"absolute",overflow:"hidden",width:"1px",height:"1px",opacity:"0",textIndent:"-999em"}))}if("horizontal"===g.direction&&(j="rtl"===f.checkDirection(String(g.text))?{start:"right",middle:"center",end:"left"}[g.alignment]:{start:"left",middle:"center",end:"right"}[g.alignment]),f.applyStyles(e,{position:"absolute",overflow:"hidden",width:y+"px",height:z+"px",top:x+"px",left:w+"px",padding:B+"px "+A+"px",textAlign:j,direction:f.checkDirection(String(g.text)),lineHeight:m+"pt",boxSizing:"border-box"}),"vertical"===g.direction||"vertical-lr"===g.direction)w-h._captionator_availableCueArea.left-h._captionator_availableCueArea.left>=h._captionator_availableCueArea.right-(w+y)?h._captionator_availableCueArea.right=w:h._captionator_availableCueArea.left=w+y,h._captionator_availableCueArea.width=h._captionator_availableCueArea.right-h._captionator_availableCueArea.left;else{if(e.scrollHeight>1.2*e.offsetHeight)if(g.snapToLines){for(var S=0;e.scrollHeight>1.2*e.offsetHeight;)z+=q,e.style.height=z+"px",S++;x-=S*q,e.style.top=x+"px"}else z=e.scrollHeight+B,n=u.controlHeight+z+2*B,x=(u.height-n)*(g.linePosition/100),e.style.height=z+"px",e.style.top=x+"px";x-h._captionator_availableCueArea.top-h._captionator_availableCueArea.top>=h._captionator_availableCueArea.bottom-(x+z)&&h._captionator_availableCueArea.bottom>x?h._captionator_availableCueArea.bottom=x:h._captionator_availableCueArea.top<x+z&&(h._captionator_availableCueArea.top=x+z),h._captionator_availableCueArea.height=h._captionator_availableCueArea.bottom-h._captionator_availableCueArea.top}},f.convertFontSizePercentage=function(a){switch(a){case"50%":return 2.65;case"150%":return 5.3*1.5;case"200%":return 10.6;default:return 5.3}},f.updateCCPrefs=function(a,b){a.vtt||(e=b||e,c=f.convertFontSizePercentage(e.fontSize),a._captionator_dirtyBit=!0,f.rebuildCaptions(a))},f.styleCueCanvas=function(g){var h,i,j,k,l;g._containerObject&&(j=g._containerObject,k=$(j),l=j.id);var m=f.getNodeMetrics(g);h=m.height*(c/100)/96*72,h=h>=a?h:a,i=Math.floor(parseFloat(h,10)*d),i=i>b?i:b,k.css({"-webkit-transition":"-webkit-transform 0.5s ease",position:"absolute",overflow:"hidden",width:"100%",height:"100%",top:0,left:0,color:e.fontColor,fontFamily:e.fontFamily,fontSize:h+"pt",boxSizing:"border-box"}),k.find(".captionator-cue").css({lineHeight:i+"pt"}),f.updateSpanStyles(k)},f.updateSpanStyles=function(a){var b=$.extend({},e.containerCSS);delete b.fontSize,delete b.fontFamily,b.padding="2px 9px 4px 10px",$.each(a.find(".mtvn-cue"),function(a,c){$(c).css(b)}),b=$.extend({},e.textCSS),delete b.fontSize,delete b.fontFamily,$.each(a.find(".mtvn-cue-text"),function(a,c){$(c).css(b)})},f.compareArray=function(a,b){if(!(a instanceof Array&&b instanceof Array))return!1;if(a.length!==b.length)return!1;for(var c in a)if(a.hasOwnProperty(c)&&a[c]!==b[c])return!1;return!0},f.generateID=function(a){var b="";for(a=a?a:10;b.length<a;)b+=String.fromCharCode(65+Math.floor(26*Math.random()));return"captionator"+b}}();